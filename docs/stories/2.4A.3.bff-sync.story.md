# 2.4A.3 BFF Sync (Brownfield Story)

Status: Draft
Epic: 2.4A — Realtime Configurator Validation & UX
Owner: TBD
Priority: P1
Labels: bff, cache, initialization

## 배경/문맥
컨피규레이터 초기화 시 2.3A 확정 값(제약/재질/룰)을 BFF에서 일관되게 제공하고, 캐시 워밍을 통해 초기 응답 성능을 보장한다.

## 목표/가치
- 초기 렌더 품질 및 일관성 확보(제약/재질/룰 동기)
- 초기 요청 성능 개선(materials:list 캐시 워밍)

## 수용 기준 (Acceptance Criteria)
1) 초기화 일치성
- BFF 응답의 제약/재질/룰이 2.3A 값과 일치

2) 캐시/성능
- warmupCache('materials:list') 사용 및 초기 요청 p95 < 500ms 기여

## 산출물/변경 파일
- src/app/api/v1/bff/configurator/route.ts
- __tests__/api/v1/bff/configurator.initialization.test.ts

## 테스트 전략
- 통합: 응답 스키마에 제약/재질/룰 포함 및 캐시 히트 경로 확인

---

## SM Story Checklist (2.4A.3)

결론: Draft — Ready for PO/QA review

- 목적/가치: PASS — 초기화 동기/성능 목표 명확
- 범위/의존성: PASS — 2.3A 값 연동, 캐시 워밍 키 고정
- 수용 기준: PASS — 일치성/성능 기준 고정
- 산출물/태스크: PASS — 구현/테스트 파일 명시
- 테스트 전략: PASS — 통합 테스트 경로 제시

Action Items
- (없음)

---

## PO Validation Results (2.4A.3)

결론: Approved

요약
- 초기화 동기/캐시 워밍 기준이 명확합니다. 응답 스키마의 필수 키 목록을 명시하면 구현·테스트 일관성이 높아집니다.

보완 지시(문장 수준 고정)
1) 응답 필수 키
- materials: [{ id, name, type, is_active, thumbnail_url }]
- rules: { base_price, size_multiplier, material_multipliers, finish_multipliers }
- constraints: { width_cm: {min,max,step}, depth_cm, height_cm }

2) 캐시 워밍 로그 키
- `warmup:materials:list` 1회/부팅, TTL/사이즈 정보 포함.

# 🛋️ 3D 책상 컨피규레이터 플랫폼 Product Requirements Document (PRD)

## Goals and Background Context

### Goals
- 시장 진입: 출시 후 6개월 내에 온라인 맞춤형 책상 시장에서 5%의 시장 점유율을 달성합니다.
- 구매 전환율 증대: 3D 컨피규레이터 사용자의 구매 전환율을 업계 평균(2%)보다 높은 5%로 달성합니다.
- 고객 만족도 향상: 사용자 만족도 설문조사에서 5점 만점에 4.5점 이상을 획득합니다.

### Background Context
이 프로젝트는 온라인 가구 구매 시 소비자들이 겪는 시각적 확신 부족, 맞춤 제작의 복잡함, 그리고 가격 투명성 부족 문제를 해결하기 위해 시작되었습니다. 재택근무 증가와 개인 맞춤화 제품에 대한 소비자들의 기대가 높아지는 현 시장 상황을 고려하여, 저희는 실시간 3D 시각화, 즉각적인 가격 확인, 그리고 자동 도면 생성을 통해 기존의 문제를 해결하고자 합니다.

### Change Log
| Date | Version | Description | Author |
|:---|:---|:---|:---|
| 2025-09-25 | 1.0 | 초기 PRD 작성 | PM John |
| 2025-09-29 | 1.1 | FR1 재료 요구사항 기존 API 호환으로 수정, Epic 5 추가 | Sarah (PO) |
| 2025-10-01 | 1.2 | Epic 6 추가 (도커 환경 구성), NFR4 추가 | Sarah (PO) |

## Requirements

### Functional
1. FR1 (3D 컨피규레이터): 사용자는 웹 및 모바일 환경에서 3D 컨피규레이터를 통해 책상의 가로, 세로, 높이를 1cm 단위로 조절할 수 있어야 합니다. 또한, 재료(원목, 메탈, 유리, 패브릭) 및 색상 옵션을 선택할 수 있으며, 선택한 옵션은 3D 모델에 즉시 반영되어야 합니다.
2. FR2 (실시간 가격 계산): 모든 옵션 변경(크기, 재료, 색상 등) 시 실시간으로 가격이 업데이트되어 표시되어야 하며, 기본 가격과 각 옵션별 추가/할인 가격이 명확하게 분리되어 표시되어야 합니다.
3. FR3 (도면 생성 및 다운로드): 완성된 디자인의 기술 도면을 PDF 형식으로 자동 생성하고 다운로드할 수 있어야 합니다. 도면은 책상의 정면, 측면, 평면도를 포함해야 하며, 각 파트의 치수(단위: mm)와 재료 정보가 상세히 표기되어야 합니다.
4. FR4 (구매 연동): 사용자는 커스터마이징된 제품을 장바구니에 담아 기존 쇼핑몰 결제 시스템을 통해 구매할 수 있어야 합니다. 이 과정에서 기존 쇼핑몰의 API와 데이터 형식을 준수해야 합니다.
5. FR5 (계정 관리): 사용자는 회원가입/로그인을 통해 자신의 디자인을 저장하고, 마이페이지에서 저장된 디자인을 불러오거나 수정할 수 있어야 합니다.

### Non Functional
1. NFR1 (성능): 3D 컨피규레이터는 모든 주요 브라우저의 최신 2개 버전을 지원해야 하며, 모바일 환경에서 30 FPS 이상의 렌더링 성능을 유지해야 합니다.
2. NFR2 (확장성): 시스템은 동시 접속자 1,000명 환경에서도 안정적인 성능을 유지할 수 있는 서버리스 아키텍처로 설계되어야 합니다.
3. NFR3 (보안): 사용자 계정 및 결제 정보는 SSL/TLS 암호화 통신을 통해 안전하게 처리되어야 합니다.
4. NFR4 (개발 환경): 모든 개발자는 도커 컴포즈를 통해 로컬 환경(Next.js 개발 서버, PostgreSQL, Supabase Auth)을 5분 이내에 구축할 수 있어야 합니다.

### Compatibility Requirements
1. CR1 (쇼핑몰 API): 장바구니 추가, 결제 요청, 주문 상태 업데이트 등 기존 쇼핑몰의 정의된 API 엔드포인트를 사용하고, 각 엔드포인트의 입력/출력 데이터 형식을 준수해야 합니다.
2. CR2 (도면 형식): 생성된 기술 도면은 제작 업체가 사용하는 PDF 표준 형식을 준수하여 생산에 활용할 수 있어야 합니다.

## User Interface Design Goals

### Overall UX Vision
저희의 목표는 사용자가 직관적이고 몰입도 높은 경험을 통해 복잡한 커스터마이징 과정을 즐겁게 느끼게 하는 것입니다. 실시간 3D 시각화는 단순히 기능을 제공하는 것을 넘어, 사용자의 창의성을 자극하는 핵심적인 요소가 되어야 합니다.

### Key Interaction Paradigms
- **실시간 피드백**: 모든 사용자 입력(치수, 재료, 색상 변경)에 대해 3D 모델과 가격이 즉시 업데이트
- **직관적 조작**: 마우스/터치 기반 3D 뷰 회전, 줌, 이동 기능으로 자연스러운 탐색 경험
- **단계별 가이드**: 첫 방문 사용자를 위한 온보딩 튜토리얼 및 툴팁 시스템
- **비교 모드**: 여러 디자인 옵션을 나란히 비교할 수 있는 기능
- **실시간 협업**: 디자인 링크 공유를 통한 간접 협업 지원

### Core Screens and Views
- **로그인/회원가입 화면**: Supabase 인증 기반 사용자 등록 및 로그인
- **3D 컨피규레이터 메인 화면**: 3D 뷰포트 + 옵션 패널 (재료, 치수, 색상 선택)
- **실시간 가격 표시 패널**: 기본가/옵션가/총가격 분리 표시, 부가세 토글
- **마이 디자인 페이지**: 저장된 디자인 목록, 썸네일, 상세 정보 관리
- **도면 생성 모달**: PDF 도면 생성 진행 상태 및 다운로드
- **장바구니/결제 리디렉션**: 기존 쇼핑몰로 안전한 이동 처리

### Accessibility
**WCAG 2.1 AA 준수**
- 키보드 네비게이션 완전 지원 (Tab, Enter, Esc 키 활용)
- 스크린 리더 호환성 (ARIA 레이블, role 속성 명시)
- Color contrast ratio 4.5:1 이상 (텍스트 및 UI 요소)
- 폼 요소에 명확한 레이블 및 에러 메시지
- 대체 텍스트 제공 (3D 모델 스냅샷, 아이콘 등)

### Branding
- **컬러 팔레트**: Tailwind CSS 기반 일관된 색상 시스템 (primary, secondary, accent 색상 정의)
- **타이포그래피**: 시스템 폰트 스택 활용으로 빠른 로딩 및 가독성 확보
- **디자인 언어**: 미니멀리즘, 모던한 플랫 디자인, 부드러운 애니메이션
- **로고 및 아이콘**: Shadcn/ui 아이콘 세트 활용, 일관된 크기 및 스타일

### Target Device and Platforms
**Web Responsive (Mobile First Approach)**
- **모바일**: iOS Safari, Chrome (최신 2개 버전), 반응형 터치 UI
- **태블릿**: iPad, Android 태블릿 (가로/세로 모드 지원)
- **데스크톱**: Chrome, Safari, Firefox, Edge (최신 2개 버전), 1920×1080 이상 최적화
- **3D 성능**: WebGL 지원 브라우저 필수, 모바일 30 FPS 이상 유지

### Technical Assumptions

### Repository Structure: Monorepo
프로젝트는 모노레포(Monorepo) 구조로 구성되며, 프런트엔드와 백엔드 코드를 단일 저장소에서 관리합니다. 이를 통해 코드 공유, 일관된 버전 관리, 효율적인 의존성 관리가 가능합니다.

### Service Architecture: Serverless
Vercel Serverless Functions 기반으로 확장 가능하고 비용 효율적인 아키텍처를 구축합니다. BFF (Backend For Frontend) 패턴을 적용하여 API Gateway Service로 여러 백엔드 서비스를 통합하고, 프런트엔드 복잡도를 감소시킵니다.

**핵심 기술 스택:**
- **Frontend**: Next.js 14.x (App Router), Three.js r169 (3D 렌더링)
- **Backend**: Node.js v20.x (서버리스 함수), Supabase (PostgreSQL 15)
- **Language**: TypeScript 5.3.x (strict mode)
- **Styling**: Tailwind CSS 3.x + Shadcn/ui (컴포넌트 라이브러리)

### Testing Requirements: Unit + Integration
포괄적인 테스트 전략으로 코드 품질과 안정성을 확보합니다:
- **단위 테스트 (Jest)**: API 라우트, 라이브러리, 유틸리티 함수
- **통합 테스트 (React Testing Library)**: 컴포넌트 상호작용, 인증 플로우
- **E2E 테스트 (Playwright)**: 주요 사용자 시나리오 검증
- **성능 테스트**: 3D 렌더링 성능, API 응답 시간 측정

**커버리지 목표:**
- API 라우트: 90% 이상
- 라이브러리: 95% 이상
- 전체: 80% 이상

### Additional Technical Assumptions and Requests
**3D 렌더링 환경:**
- Three.js r169 고정 버전 사용 (안정성 확보)
- WebGL 필수, 브라우저 호환성 체크 로직 포함
- 모바일 환경 30 FPS 이상 렌더링 성능 필수

**보안 요구사항:**
- Supabase RLS (Row Level Security) 활성화
- JWT 토큰 기반 인증 및 CSRF 보호
- API Rate Limiting 적용 (분당 5-10회)

**성능 최적화:**
- Vercel Edge Functions Cold Start 최소화
- API 응답 캐싱 (가격 정책 1시간 TTL)
- 3D 컴포넌트 코드 스플리팅

**배포 및 운영:**
- Vercel 호스팅 최적화 설정
- Supabase 클라이언트 싱글톤 패턴
- 환경별 설정 분리 (개발/스테이징/프로덕션)

**외부 통합:**
- 기존 쇼핑몰 API 호환성 준수 (CR1)
- PDF 도면 표준 형식 준수 (CR2)
- 리다이렉트 기반 결제 연동 (복잡한 API 통합 회피)

## Epic List

1. Epic 1: 플랫폼 인프라 및 기반 기능 구축
2. Epic 2: 3D 컨피규레이터 핵심 기능 개발
3. Epic 3: 가격 시스템 연동 및 구매 프로세스 통합
4. Epic 4: 도면 생성 및 사용자 디자인 관리
5. Epic 5: 확장 재료 시스템 (MDF, 스틸 등 추가 재료 지원)
6. Epic 6: 개발 환경 및 배포 인프라 개선 (도커 컨테이너화)

## Epic 1: 플랫폼 인프라 및 기반 기능 구축

**Epic Goal:**
Next.js 14.x 기반 모노레포 프로젝트 구조와 개발 환경을 완전히 구축하고, 사용자 인증 시스템, UI 컴포넌트 라이브러리, API 라우트 구조를 완성하여 3D 컨피규레이터 개발을 위한 견고한 기반을 마련합니다. 이를 통해 후속 Epic들이 일관된 아키텍처와 재사용 가능한 컴포넌트를 활용할 수 있도록 합니다.

### Story 1.1: 프로젝트 기반 인프라 설정

**As a** 개발팀,
**I want** Next.js 기반의 모노레포 프로젝트 구조와 기본 개발 환경을 설정,
**so that** 3D 책상 컨피규레이터 플랫폼 개발을 위한 견고한 기반을 마련할 수 있습니다.

**Acceptance Criteria:**
1. Next.js 14.x 프로젝트가 TypeScript 5.3.x와 함께 초기화되어야 함
2. Tailwind CSS 3.x가 설정되고 작동해야 함
3. Supabase 클라이언트 설정이 완료되어야 함
4. 모노레포 구조의 기본 폴더 구조가 생성되어야 함
5. 개발 서버가 정상적으로 실행되어야 함
6. 기본 ESLint 및 Prettier 설정이 적용되어야 함

### Story 1.2: 사용자 인증 시스템

**As a** 플랫폼 사용자,
**I want** 회원가입, 로그인, 로그아웃 기능을 통해 안전하게 인증할 수 있는 시스템,
**so that** 나만의 3D 책상 디자인을 저장하고 관리할 수 있으며, 개인화된 서비스를 받을 수 있습니다.

**Acceptance Criteria:**
1. 사용자는 이메일과 비밀번호로 회원가입할 수 있어야 함 (비밀번호: 최소 8자, 영문+숫자 조합)
2. 등록된 사용자는 이메일과 비밀번호로 로그인할 수 있어야 함
3. 로그인된 사용자는 안전하게 로그아웃할 수 있어야 함
4. 인증 상태가 페이지 새로고침 후에도 유지되어야 함 (세션 지속성)
5. 인증되지 않은 사용자가 보호된 기능에 접근 시 로그인 페이지로 리디렉션되어야 함
6. 사용자 프로필 정보(이메일, 가입일)를 조회할 수 있어야 함
7. 인증 과정에서 명확한 상태 표시 (로딩, 성공, 실패)
8. 로그인 실패 시 보안 제한 적용 (IP당 5회/시간)

### Story 1.3: UI 컴포넌트 라이브러리 구축

**As a** 개발팀,
**I want** Shadcn/ui 기반의 재사용 가능한 UI 컴포넌트 라이브러리를 구축,
**so that** 일관된 디자인 시스템을 통해 3D 컨피규레이터 플랫폼의 사용자 인터페이스를 효율적으로 개발할 수 있습니다.

**Acceptance Criteria:**
1. Shadcn/ui CLI가 설치되고 설정되어야 함
2. 핵심 Base 컴포넌트 구현 (Button, Input, Card, Badge, Toast)
3. Layout 컴포넌트 구현 (Container, Header, Footer, Sidebar)
4. Form 컴포넌트 구현 (FormWrapper, Label, ErrorMessage, FieldGroup)
5. TypeScript 타입 안전성 확보
6. Storybook 컴포넌트 문서화 시스템 구축
7. 반응형 디자인 지원 (mobile-first)
8. 다크 모드 지원 기반 (CSS variables)
9. 컴포넌트 테스트 코드 작성
10. 보안 고려 (XSS 방지, CSRF 보호)
11. 에러 처리 (Error Boundary, 폴백 UI)

### Story 1.4: API 라우트 구조 구축

**As a** 개발팀,
**I want** Next.js App Router 기반의 체계적인 API 라우트 구조와 BFF 패턴을 구축,
**so that** 3D 컨피규레이터 플랫폼의 백엔드 서비스들을 효율적으로 구현하고 관리할 수 있습니다.

**Acceptance Criteria:**
1. Next.js App Router 기반 API 라우트 구조 체계적 구성
2. BFF (Backend For Frontend) 패턴 구현 (API Gateway, 데이터 aggregation)
3. 인증된 사용자 전용 보호 API 엔드포인트 (JWT 검증 미들웨어, RBAC)
4. 핵심 서비스별 API 구현 (옵션/가격, 디자인, 결제)
5. 에러 처리 및 로깅 시스템 (표준화된 응답, 환경별 로깅)
6. API 문서화 (OpenAPI 3.0, Swagger UI)
7. 성능 최적화 (캐싱, Cold Start 최적화)
8. 보안 강화 (Rate limiting, CORS, CSRF 검증)
9. 테스트 코드 (API 엔드포인트, 통합 테스트)
10. 개발 도구 설정 (디버깅, 로컬 환경)

## Epic 2: 3D 컨피규레이터 핵심 기능 개발

**Epic Goal:**
Three.js r169 기반 3D 렌더링 환경을 구축하고, 책상 모델의 재료 선택 및 치수 조절 기능을 구현하며, 실시간 가격 계산 시스템을 통합하여 사용자가 직관적으로 책상을 커스터마이징할 수 있는 완전한 3D 컨피규레이터 경험을 제공합니다. Epic 5의 확장 재료 시스템(MDF, 스틸, 메탈, 유리, 패브릭)을 통합하여 총 6가지 재료 옵션을 지원합니다.

### Story 2.1: 3D 컨피규레이터 기반 구조 구축

**As a** 플랫폼 사용자,
**I want** 웹 브라우저에서 3D 책상 컨피규레이터의 기본 3D 렌더링 환경과 인터랙션 기능을 사용,
**so that** 실시간으로 책상을 시각적으로 커스터마이징하고 재료/색상 변경사항을 즉시 확인할 수 있습니다.

**Acceptance Criteria:**
1. Three.js r169 기반 3D 렌더링 환경 구축 (WebGL, 씬 초기화, 기본 책상 모델)
2. 3D 카메라 컨트롤 (OrbitControls, 줌, 모바일 터치)
3. 기본 재료 선택 시스템 (원목, MDF, 스틸 → **Epic 5 통합 후 6종**)
4. 치수 조절 기본 시스템 (1cm 단위, 실시간 반영)
5. 성능 요구사항 (모바일 30 FPS, 주요 브라우저 지원)
6. BFF API 연동 (`/api/v1/bff/configurator`)
7. UI/UX 요구사항 (반응형, 로딩/에러 처리, WCAG 2.1 AA)
8. 테스트 코드 (3D 씬, 재료/치수, 성능)
9. 개발 도구 (Three.js 디버깅, 에셋 관리)

### Story 2.2: 실시간 가격 계산 시스템 (Epic 5 통합)

**As a** 플랫폼 사용자,
**I want** 3D 컨피규레이터에서 재료, 크기, 색상 변경 시 실시간 가격 계산 및 표시,
**so that** 구매 전 투명한 가격 정보 확인 및 예산 맞춤 옵션 선택이 가능합니다.

**Acceptance Criteria:**
1. 실시간 가격 계산 엔진 (치수, 재료 변경 즉시 업데이트, 6종 재료 지원)
2. 가격 표시 UI (기본가/옵션가/총가격 분리, 부가세 토글)
3. 성능 최적화 (500ms 이내, 디바운싱, 모바일 최적화)
4. BFF API 연동 (`/api/v1/pricing/calculate`)
5. 가격 정책 관리 (6종 재료 배수: 원목 1.0, MDF 0.8, 스틸 1.15, 메탈 1.5, 유리 2.0, 패브릭 0.8)
6. 에러 처리 (API 에러 시 이전 가격 유지, 로컬 추정)
7. 테스트 코드 (계산 로직, API, 성능)

**Epic 5 통합 사항:**
- 기존 3종 재료(원목/MDF/스틸) → 6종 재료(원목/MDF/스틸/메탈/유리/패브릭) 확장
- 재료별 단가 배수 시스템 적용
- Story 2.1의 재료 선택 UI 자동 확장

## Epic 3: 가격 시스템 연동 및 구매 프로세스 통합

**Epic Goal:**
사용자가 3D 컨피규레이터에서 완성한 맞춤 책상을 장바구니에 담고, 기존 쇼핑몰의 결제 시스템으로 안전하게 리디렉션하여 구매를 완료할 수 있도록 합니다. 리다이렉트 기반의 단순 통합 전략으로 복잡한 API 연동을 회피하며, 가격 조작 방지 및 보안 검증을 통해 안전한 구매 프로세스를 제공합니다.

### Story 3.1: 장바구니 및 결제 연동

**As a** 플랫폼 사용자,
**I want** 3D 컨피규레이터에서 완성한 맞춤 책상을 장바구니에 담고 기존 쇼핑몰로 안전하게 이동,
**so that** 복잡한 과정 없이 익숙한 결제 시스템으로 편리하게 구매 완료할 수 있습니다.

**Acceptance Criteria:**
1. 장바구니 추가 기능 (디자인 데이터 저장, 사용자 인증 확인)
2. 기존 쇼핑몰 API 연동 (데이터 변환, 보안 토큰 인증)
3. 결제 시스템 리디렉션 (자동 이동, URL 파라미터 전달)
4. 구매 데이터 추적 (로그 저장, 히스토리 관리)
5. 보안 및 검증 (무결성 검증, 서버 사이드 가격 재계산)
6. 사용자 경험 최적화 (로딩/피드백, 모바일 리디렉션)
7. 테스트 코드 (장바구니, API 연동, 리디렉션)

## Epic 4: 도면 생성 및 사용자 디자인 관리

**Epic Goal:**
완성된 책상 디자인의 기술 도면을 PDF로 생성하고 다운로드할 수 있도록 하며, 사용자가 자신의 디자인을 저장, 조회, 수정, 삭제할 수 있는 관리 시스템을 제공합니다. Vercel Serverless 시간 제한에 대응하는 비동기 도면 생성 시스템과 RLS 기반 보안 정책을 통해 안전하고 효율적인 디자인 관리 경험을 제공합니다.

### Story 4.1: 도면 생성 및 디자인 관리

**As a** 플랫폼 사용자,
**I want** 완성된 책상 디자인의 기술 도면을 PDF로 생성/다운로드하고 내 디자인 관리,
**so that** 제작 업체에 정확한 사양 전달 및 이전 디자인 재사용이 가능합니다.

**Acceptance Criteria:**
1. 도면 생성 기능 (비동기 PDF 생성, 3가지 뷰, mm 단위, 재료 정보)
2. 비동기 처리 및 피드백 (Serverless 10초 제한 대응, 로딩/완료 알림)
3. PDF 다운로드 (Supabase Storage 저장, 다운로드 링크)
4. 디자인 관리 페이지 (`/my-designs`, 목록/썸네일/정보)
5. 디자인 CRUD API (`GET/PUT/DELETE /api/v1/designs`)
6. 보안 및 권한 (RLS, 인증 확인, Rate Limiting)
7. 테스트 코드 (도면 생성, 비동기, CRUD, PDF)

## Epic 5: 확장 재료 시스템 (Story 2.2에 통합 완료)

**Epic Goal:**
기존 3종 재료(원목, MDF, 스틸)에서 추가로 메탈, 유리, 패브릭을 지원하여 총 6종 재료 옵션을 제공하고, 각 재료별 가격 배수를 적용한 정밀한 가격 계산 시스템을 구축합니다.

**통합 상태:**
Epic 5는 별도 스토리가 아닌 **Story 2.2 (실시간 가격 계산 시스템)**에 통합 완료되었습니다.
- 재료 확장: 원목/MDF/스틸/메탈/유리/패브릭 (6종)
- 가격 배수: 원목(1.0), MDF(0.8), 스틸(1.15), 메탈(1.5), 유리(2.0), 패브릭(0.8)
- Story 2.1의 3D 컨피규레이터 재료 선택 UI도 자동 확장

## Epic 6: 개발 환경 및 배포 인프라 개선 (도커 컨테이너화)

**Epic Goal:**
모든 개발자가 도커 컴포즈를 통해 로컬 개발 환경(Next.js 개발 서버, PostgreSQL, Supabase Auth)을 5분 이내에 구축할 수 있도록 하여 NFR4 요구사항을 충족합니다.

**현재 상태: 계획됨, 미구현 ⏸️**

Epic 6는 현재 PRD에 정의되어 있으나 구현되지 않았습니다. 향후 스프린트에서 다음 내용을 구현할 예정입니다:
- Docker Compose 설정 파일 작성 (Next.js, PostgreSQL, Supabase)
- 로컬 개발 환경 빠른 구축 스크립트
- 환경 변수 자동 설정 및 시드 데이터 제공
- 개발자 온보딩 가이드 문서

## Next Steps

### UX Expert Sally에게 전달할 최종 프롬프트

**UX Expert Sally:**

**Task**: 이 PRD와 UI/UX 사양을 기반으로, 다음 핵심 지침을 포함하는 상세한 **UI/UX 사양(front-end-spec.md)**을 최종 확정해 주십시오.

1. **3D 지연 UX 전략**: Serverless Cold Start 지연에 대응하여 **스켈레톤 UI** 및 **명확한 메시지**를 사용하는 UX 전략을 구체적으로 정의합니다.
2. **3D 조작 민감도 기준**: 모바일 터치 및 데스크톱 마우스 조작에 대한 **수치적 민감도 기준**을 명시하여 개발팀의 조작감 구현을 가이드합니다.
3. **컴포넌트 명세**: Tailwind CSS 및 Shadcn/ui 기반의 **핵심 컴포넌트 명세**를 최종 확정합니다.

### Architect Winston에게 전달할 최종 프롬프트

**Architect Winston:**

**Task**: 이 PRD와 최종 UI/UX 사양을 기반으로 **Fullstack Architecture Document**를 최종 확정해 주십시오. 다음 핵심 설계 전략이 **Serverless Functions** 및 **Supabase** 환경에 완벽하게 구현되도록 상세한 지침을 제공해 주십시오.

1. **통합 및 보안**: **BFF 도입**, **토큰 기반 보안 중계 로직**을 통해 레거시 쇼핑몰과의 연동 보안을 확보합니다.
2. **성능 및 비용**: **Warm-up 전략** 및 **비동기 도면 생성 로직**을 포함하는 Serverless 환경의 성능 및 비용 문제를 해결합니다.
3. **데이터 모델**: **RLS(Row Level Security) 설정** 및 **핵심 속성 분리**를 포함하는 DB 스키마 생성 스토리를 명확히 정의합니다.